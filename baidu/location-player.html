<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <title>map</title>
    <link rel="stylesheet" type="text/css" href="map.css">
</head>

<body>
    <div id="map_container"></div>
    <div id="map_control">
        <button id="play">play</button>
        <button id="next">next</button>
        <button id="stop">stop</button>
        <button id="pause">pause</button>
        <button id="resume">resume</button>
        <button id="replay">replay</button>
        <button id="addPath">addPath</button>
        <button id="updatePath">updatePath</button>
    </div>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ttwaH5NADcpIkNc7wfMpKBpK"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
    <script src="map.js"></script>
    <script src="location-player.js"></script>
    <script>
        Map.init(function (map) {
            var loc_24 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 121.35036, 31.15049, 121.35036, 31.15049, 0, 0, 121.442, 31.30129001, 121.46215, 31.25113001, 0, 0, 0, 0, 121.50526, 31.25189001, 121.47827, 31.24286001, 121.44182, 31.21306001, 0, 0, 121.51779, 31.24404001, 121.49538, 31.25269001, 121.4686, 31.24137001, 121.50526, 31.25189001, 0, 0, 121.46326, 31.24593001, 0, 0, 121.27481, 31.25434001];

            var locations = Converter.fromLngLatArray(loc_24);

            // var locations = [
            //     { "lng": 117.242926, "lat": 39.074929 }, 
            //     { "lng": 117.264773, "lat": 39.078514 },
            //     { "lng": 117.281302, "lat": 39.080643 }, 
            //     { "lng": 117.290932, "lat": 39.070223 }, 
            //     { "lng": 117.272822, "lat": 39.058906 }, 
            //     { "lng": 117.260605, "lat": 39.054311 }, 
            //     { "lng": 117.23344, "lat": 39.048819 }, 
            //     { "lng": 117.211306, "lat": 39.061147 }
            // ];

            var points = Converter.toMapPoints(locations);

            var player = new LocationPlayer(points)
                .onPlay(function (point, playIndex, total) {
                    if (playIndex == 0) {
                        map.setCenter(point);
                    }
                    Overlays.addIndexMarker(map, playIndex, point);
                    console.log('onPlay', playIndex);
                })
                .onPause(function () {
                    console.log('onPause');
                })
                .onResume(function () {
                    console.log('onResume');
                })
                .onStop(function () {
                    console.log('onStop');
                })
                .onFinish(function () {
                    console.log('onFinish');
                });

            function _click(id, fn) {
                document.getElementById(id).addEventListener('click', fn);
            }

            _click('play', function () {
                player.play();
            });

            _click('next', function () {
                player.next();
            });

            _click('stop', function () {
                player.stop();
            });

            _click('pause', function () {
                player.pause();
            });

            _click('resume', function () {
                player.resume();
            });

            _click('replay', function () {
                player.replay();
            });

            _click('addPath', function () {
            });

            _click('updatePath', function () {
            });
        })

    </script>
</body>

</html>